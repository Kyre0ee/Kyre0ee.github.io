---
layout: post
title: 第八章 
date: 2019-05-08 15:57 +0800
tags: 计组-MIPS汇编
excerpt: "MIPS操作系统硬件实现基础知识学习笔记"
toc: true
---
# 第八章
***
## 1. 数据通路和时序控制

数据通路和时序控制是计算机中的核心组成部分，用于执行指令并控制数据流动的路径和时序。

- **数据通路（Data Path）**：负责执行指令中的操作，并处理数据的传输和运算。
  
- **时序控制（Timing Control）**：负责协调各个部件的工作时序，确保指令的正确执行顺序。

## 2. 总线式数据通路

总线式数据通路采用总线作为数据传输的主要通道，包括数据总线、地址总线和控制总线。

数据总线传输数据信息，地址总线传输地址信息，控制总线传输控制信号。

## 3. MIPS单周期数据通路

MIPS单周期数据通路采用单周期执行模式，每条指令占用一个时钟周期。

指令的执行分为取指、译码、执行、访存和写回等阶段，各阶段由数据通路中的不同部件完成。

## 4. MIPS单周期控制器设计

MIPS单周期控制器负责生成各个阶段的控制信号，以控制数据通路中各个部件的工作。

控制信号包括指令寄存器的读写使能、ALU运算类型、写回数据选择等。

## 5. MIPS多周期数据通路概述

MIPS多周期数据通路采用多周期执行模式，每条指令执行分为多个时钟周期。

指令的执行过程被分解为取指、译码、执行、访存和写回等多个阶段，每个阶段耗时一个时钟周期。

## 6. MIPS多周期数据通路设计

MIPS多周期数据通路通过增加状态寄存器和控制逻辑实现多周期执行。

每个阶段的控制信号由控制器根据当前状态和指令类型动态生成。

## 7. 硬连线路控制器设计

硬连线路控制器采用组合逻辑电路实现，根据当前指令的类型和操作数生成控制信号。

硬连线路控制器简单、速度快，但扩展性较差，适用于固定指令集的情况。

## 8. 微程序设计基本原理

微程序设计采用微指令序列控制数据通路的工作。

微指令序列存储在控制存储器中，根据当前指令的操作类型和地址生成相应的微指令序列。

## 9. 微指令格式设计

微指令格式包括操作字段、地址字段和控制字段等，用于表示微指令的操作和控制信息。

微指令格式的设计需要考虑指令的种类和控制信号的数量。

## 10. 微地址确定方式

微地址确定方式是指确定下一条微指令地址的方法。

常见的微地址确定方式包括顺序方式、条件跳转方式和间接跳转方式等。

## 11. 中断和异常处理概述

中断和异常是计算机处理器在执行过程中遇到的一种特殊情况，需要及时处理以确保系统的稳定运行。

中断是由外部设备发起的，而异常是由指令执行过程中的错误引发的。

## 12. MIPS带异常处理的数据通路设计

MIPS带异常处理的数据通路在单周期或多周期的基础上增加了异常处理的支持。

当发生异常时，控制器会暂停当前指令的执行，转而执行异常处理程序，并在处理完成后恢复正常执行。

## 13. MIPS流水线数据通路设计

MIPS流水线数据通路将指令执行过程划分为多个阶段，并将多条指令同时执行，提高了处理器的性能。

流水线数据通路需要解决数据冒险、控制冒险等问题，通过数据前推、流水线中断等技术进行优化。

## 14. MIPS流水线控制器

MIPS流水线控制器负责协调流水线中各个阶段的工作，并解决流水线中的冒险问题。

流水线控制器需要处理数据相关、控制相关和结构相关等冒险情况，以确保流水线的正常运行。

### 指令流水线冲突冒险处理方式及对比

在计算机组成原理中，指令流水线是提高处理器性能的重要技术，但同时也会引入冲突冒险，影响流水线的效率。为了处理这些冲突，设计者采用了多种不同的方法。下面将详细介绍几种常见的指令流水线冲突冒险处理方式，并对它们进行对比分析。

#### 1. 数据相关（Data Hazards）处理方式

数据相关是指当前指令需要依赖前一条或者前几条指令的运算结果，而这些结果尚未计算完成。常见的数据相关处理方式包括：

##### 数据前推（Forwarding）

- **操作原理：** 将数据直接从产生数据的阶段传递给需要使用该数据的指令，而不是等待该数据写入寄存器后再读取。
- **优点：** 可以减少因为数据相关导致的停顿周期，提高流水线效率。
- **缺点：** 硬件实现较为复杂，可能增加成本和功耗。

##### 数据旁路（Bypassing）

- **操作原理：** 在数据相关发生时，将数据从其他地方直接传递给需要使用该数据的指令，而不是等待数据从寄存器中读取。
- **优点：** 减少了数据相关带来的停顿周期，提高了指令执行效率。
- **缺点：** 需要额外的硬件支持，并且可能增加设计复杂度。

#### 2. 控制相关（Control Hazards）处理方式

控制相关是指在分支指令处，由于分支条件未满足或者延迟槽指令未执行完毕导致的冲突。常见的控制相关处理方式包括：

##### 预测转移（Branch Prediction）

- **操作原理：** 在执行分支指令时，预测分支的方向，并提前执行预测的分支路径。如果预测正确，则减少了因分支带来的停顿周期；如果预测错误，则需要清除错误预测路径上的指令，并重新执行正确的分支路径。
- **优点：** 能够有效地降低分支带来的停顿周期，提高指令流水线的效率。
- **缺点：** 预测不准确时会导致性能下降，需要额外的清理工作。

##### 分支延迟槽（Branch Delay Slot）

- **操作原理：** 在分支指令的后面插入一条指令，这条指令在分支指令执行前就已经开始执行。这样可以利用分支指令的执行时间，减少由于分支带来的停顿周期。
- **优点：** 可以最大限度地利用流水线资源，减少由分支带来的性能损失。
- **缺点：** 需要插入额外的指令，可能导致代码膨胀和复杂度增加。

#### 3. 结构相关（Structural Hazards）处理方式

结构相关是指由于硬件资源有限导致的冲突，例如多个指令需要访问同一个硬件模块。常见的结构相关处理方式包括：

##### 插空周期（Stalling）

- **操作原理：** 在发生结构相关时，暂停流水线中的部分阶段，等待冲突解决后再恢复执行。这样虽然可以解决冲突，但会导致流水线停顿，影响执行效率。
- **优点：** 硬件实现简单，不需要额外的硬件支持。
- **缺点：** 会导致流水线停顿，降低执行效率。

##### 重叠执行（Overlapping）

- **操作原理：** 在流水线中使用多个硬件资源，使得多条指令可以同时执行，从而减少结构相关带来的停顿周期。
- **优点：** 可以提高整体执行效率，充分利用硬件资源。
- **缺点：** 需要更多的硬件资源支持，可能增加设计复杂度和成本。

#### 对比分析

- **数据相关处理方式：** 数据前推和数据旁路都能有效减少数据相关带来的停顿周期，但前者需要更复杂的硬件实现。
- **控制相关处理方式：** 预测转移和分支延迟槽都能降低分支带来的停顿周期，但前者需要额外的预测逻辑。
- **结构相关处理方式：** 插空周期简单可行，但会降低执行效率；重叠执行能提高效率，但需要更多硬件资源。

综上所述，选择合适的指令流水线冲突冒险处理方式应综合考虑性能、复杂度和成本等因素，以达到最优的设计目标。

***
