---
layout: post
title: 第四章 网络层
date: 2019-04-04 15:57 +0800
tags: 计算机网络
excerpt: "计算机网络-网络层学习笔记。"
toc: true
---
# 1. 网络层概论

## 1.1 网络层（分组）的作用

网络层的目的是实现两个端系统之间的数据透明传送，具体功能包括寻址和路由选择、连接的建立、保持和终止等。它提供的服务使传输层不需要了解网络中的数据传输和交换技术，提供端到端的服务。

## 1.2 网际层协议IP

- **ARP地址解析协议**：根据IP地址获取物理地址
- **RARP反地址解析协议**：根据物理地址找到IP地址
- **ICMP网际控制报文协议**：通过ICMP传输控制消息，如网络通不通，主机是否可达、路由是否可用等。
- **IGMP网际组管理协议**：用于管理多组播成员的通信协议，IP主机和相邻路由器利用IGMP来创建多播组的组成员，解决单播数据重复拷贝和带宽浪费的问题。

# 2. IP地址介绍、IP地址分类

## 2.1 IP地址

### IP地址的概念

- **IP地址**：IP协议提供的统一地址格式，为互联网上的每一个网络和主机分配逻辑地址，以屏蔽物理地址的差异。
- **组成**：一个IP地址由4个字节（32位）组成，一般用点分十进制表示。

### IP地址和MAC地址的区别

1. IP地址是逻辑地址，MAC地址是物理地址。
2. MAC地址是唯一的，IP地址不是唯一的。
3. MAC地址工作在数据链路层，IP地址工作在网络层。
4. MAC地址为48位，IP地址一般为32位（IPv6为128位）。
5. IP地址分配取决于网络拓扑，MAC地址分配取决于制造商。

### IP地址的组成

- 组成：主机地址和网络地址
- 主机地址/主机号：标识某一台设备的地址
- 网络地址/网络号：标识某一网段的地址
- 子网掩码：用于指明IP地址的哪些位标识子网，哪些位标识主机。用于区分网络号和主机号。

### IP地址的分类

- **A类**：
  - 网络号：第一个字节
  - 地址范围：1.0.0.1 - 127.255.255.254
  - 前缀：第一个字节第一位为0
- **B类**：
  - 网络号：前两个字节
  - 地址范围：128.0.0.1 - 191.255.255.254
  - 前缀：第一个字节前两位为10
- **C类**：
  - 网络号：前三个字节
  - 地址范围：192.0.0.1 - 223.255.255.224
  - 前缀：第一个字节前三位为110
- **D类**：
  - 用于多播
  - 地址范围：224.0.0.0 - 239.255.255.255
  - 前缀：第一个字节前四位为1110
- **E类**：保留地址

### 特殊地址

- 网络地址：主机号为全0的地址不可用
- 广播地址：主机号为全1的地址
- 回环地址：127.0.0.0

### IPv6

- 为解决IPv4地址匮乏的问题，IPv6应运而生。
- IPv6地址为128位（16字节），一般以十六进制表示。

# 3. 子网划分

- 概念：利用子网划分减少地址浪费，即VLSM（可变长子网掩码），将一个有类网络划分成若干个小子网，使IP地址使用更为科学。
- 通过修改子网掩码，更精细化地分配网络号和主机号。
- 网络掩码一般与IP地址结合使用，1的比特对应网络位，0的比特对应主机位。网络掩码中的1的个数是IP地址的网络号位数，0的个数是主机号位数。
- VLSM用于有效利用地址空间，控制路由表大小，是网络管理员常用的IP寻址技术。

# 4. 网络层路由

## 路由

- **路由**：指分组从源到目的地址，决定端到端路径的过程，路由是指导报文转发的路径信息。
- **路由器**：网络层的基本设备，用于数据转发，一个端口代表一个网段，路由器中存放通往各个网段的表格（路由表）。
- **路由表**：存储在路由器或联网计算机中的电子表格或类数据库，存储着指向特定网络地址的路径。
- **网关**：又称网间连接器、协议转换器，用于不同协议的网络互连。

## 路由获取方式

1. 直连路由
2. 静态路由
3. 动态路由

## 路由的配置方式

### 静态路由

- 由管理员直接配置，配置方便，对系统要求低，适用于拓扑结构简单稳定的小型网络。
- **缺省路由**：一种特殊的路由，当报文在路由表中找不到匹配的具体表项时使用。

### 动态路由

- 通过动态路由协议实现不同网段的路由选择。
- 动态路由协议有自己的路由算法，能自动适应网络拓扑变化，适用于有一定数量三层设备的网络。
- **动态路由协议**：
  - **RIP**：路由信息协议，基于距离矢量，适用于中小规模网络，最大跳数为15。
  - **OSPF**：开放式最短路径优先，基于链路状态协议，使用SPF算法计算最短路径，防止环路。
  - **BGP**：边界网关协议，适用于自治系统之间的路由协议。
  - **IS-IS**：中间系统到中间系统，类似OSPF，基于路由划分区域，适用于内部网关协议。

### RIP和OSPF的区别

- **RIP**：基于距离矢量协议，适用于中小型网络拓扑。
- **OSPF**：基于链路状态协议，适用于大规模网络，支持可变长度子网掩码，收敛速度快。

