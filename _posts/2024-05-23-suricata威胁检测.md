---
layout: post
title: suricata威胁检测
date: 2024-05-23 09:30
tags: DNS隧道
excerpt: "Suricata的安装以及日志文件的作用"
toc: true
---

Suricata是一种网络流量识别工具，它使用社区创建的和用户定义的signatures规则集，来检查和处理网络流量，当检测到可疑数据包时，Suricata可以触发警报。

***  

## windows按照suricata
1.安装npcap(可以下载npcap win installer)
2.规则文件下载 ProofPoint(Emerging Threads - ETPro ruleset)，安装后记得修改配置文件中的规则配置suricata.yaml
3.下载suricata适合windows安装工具进行安装
4.运行（我的需求是离线回放pcap）
log存放在D:\suricata\log
pcap存放在D:\suricata\tmp
![image](https://github.com/Kyre0ee/Kyre0ee.github.io/assets/170155695/8aebc716-d229-4208-bbe2-d6f2d737daee)

![image](https://github.com/Kyre0ee/Kyre0ee.github.io/assets/170155695/4c6021f0-5586-4c5d-90a4-1a652c42e8b6)

## suricata的日志文件介绍
- eve.json:Suricata最详细和最有用的日志文件之一。eve.json日志格式为JSON，记录所有安装的检测引擎和其他模块所生成的事件信息，如警报、HTTP请求/响应、TLS握手和SSH握手等。每个事件都包含重要的元信息，如事件戳、来自哪个接口的流量、事件类型、源/目标IP和端口、协议和应用程序信息等。
- eve.log:与eve.json相同，但格式为单行文本格式，而不是JSON。如果将Suricata其他日志聚合系统集成，则该格式可能更方便些。
- fast.log:是一个简单的文本格式文件，包含了有关网络流量中服务请求和响应的基本信息，如协议、端口、源/目标地址和事件计数等信息。这使得fast.log不像eve.json一样详细，但可以在大量流量时提供轻量级的性能提升。
- stats.log:包含与Suricata本身的统计信息相关的数据，如CPU利用率、内存使用情况以及处理的数据包数和流量量等信息，通常用于监控Suricata本身的性能和健康状况。

## suricata日志可视化
