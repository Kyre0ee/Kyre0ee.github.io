---
layout: post
title: 第三章 
date: 2019-05-03 15:57 +0800
tags: 计组-MIPS汇编
toc: true
---
# 第三章
***
## 1.总线的基本概念
+ 计算机中三大部件的功能
  - 中央处理器（CPU）：执行指令（数据加工）
  - 主存储器（MM）:存储指令和数据
  - 输入/输出（I/O）:输入程序和数据，输出程序执行结果
  计算机所有功能都是通过CPU执行指令来实现，指令和数据保存在主存储器、磁盘中，或从键盘直接输入数据。
因此：在CPU和主存之间、CPU和键盘之间、主存和磁盘之间都需要有信息交换，需要有线路互连。这个互连的线路称为总线。
+ 用系统总线对主要功能部件进行互连。
  ![image](https://github.com/kyre0e/kyre0e.github.io/assets/169347540/a3b5ccaf-7911-460a-8097-34b22da6ccee)

+ 部件的功能和指令的执行过程
  - 每个指令周期完成不同的操作任务，这些任务涉及到
    * CPU从主存取指令、取数据
    * CPU把结果数据送主存
    * CPU送数据到I/O模块，或从I/O模块获得数据
    * 主存和I/O模块之间交换数据
    * I/O模块将中断请求信号送CPU
    * CPU从I/O模块读取中断向量；等等
  
+ 部件间的信息交换
  - CPU <->主存
    * CPU须给出所访问的主存单元的地址信息
    * CPU须给出读/写控制信息
    * CPU和主存之间有数据交换
  - CPU<->I/O模块
    * CPU须给出所访问的I/O模块的地址信息
    * CPU须给出读/写控制信息
    * CPU和I/O模块之间有数据交换
  - I/O模块<->主存
    * 在某些情况下I/O模块和主存之间可以直接交换数据
    * I/O模块(如DMA控制器)要能给出所访问主存单元的地址
    * I/O模块要能给出读/写控制信息
+ 部件的外部特性
  - 与其他部件间的互连信息（交换信息）
  - 各部件的输入/出信息 内部数据：主机侧来的，如CPU、主存 外部数据：外设送来的，如键盘、鼠标
    * 如何进行信息交换？ 通过在部件之间架设通信线路，进行互连。互连方式有分散结构和总线结构。
## 2.总线的分类及组成
+ 总线在各个层次上提供部件之间的连接和信息交换通路按不同的层次分为以下几类
  - 内部总线： 指芯片内部连接各元件的总线。例如CPU芯片内部，在各个寄存器、ALU、指令部件等各元件之间有总线相连。内部总线仅传输数据信息。
  - 系统总线：指连接CPU、存储器和各种I/O模块等主要部件的总线。又称板级总线或板间总线。系统总线上要传输数据、地址和控制信息。
    * 处理器总线：早期的Intel处理器总线称为前端总线，是主板上最快的总线，主要用作处理器与北桥芯片进行信息交换。
    * 存储器总线
      - 早期的存储器总线由北桥芯片控制，处理器通过北桥芯片和主存储器、图形卡以及南桥芯片进行互连。
      - Core i7以后的处理器芯片中集成了内存控制器，因而，存储器总线直接连接到处理器。
    * I/O总线：I/O总线用于为系统中的各种I/O设备提供输入/输出通路，在物理上通常是主板上的一些I/O扩展槽和连线。
  - 通信总线：这类总线用于主机和I/O设备之间或计算机系统之间的通信。
  ![image](https://github.com/kyre0e/kyre0e.github.io/assets/169347540/52bd9460-a0f2-4fd4-a732-56466ac58307)
北桥是主存控制器集线器芯片，通过MCH芯片，可直接访问主存和显存。
南桥是一个I/O控制器集线器芯片，其中可以集成USB控制器、磁盘控制器、以太网控制器等各种外设控制器也可以通过南桥芯片引出若干主板扩展槽，用以接插一些I/O控制卡。
+ 按总线的数据传输方式来分
  - 串行总线： 按位传输，一个方向只需一根数据线，成本低，适合于远距离数据传输
    * 近年出现高速串行总线
    * 波特率：每秒钟通过信道传输的码元数。也称码元传输速率，单位为位/秒（b/s）
      
  - 并行总线：同时有多位一起传送，每一位有一根数据线，故需多根数据线。
    * 可采用突发式传送：串行和并行相结合，在一个总线事务中连续传送多个字，字与字之间串行，字中每一位并行传输。
+ 系统总线的组成
  - 一个系统总线通常由一组控制线、一组数据线和一组地址线构成。
  - 也有些总线没有单独的地址线，地址信息通过数据线来传送，这种情况称为数据/地址复用。
    * 数据线：承载在源和目的部件之间传输的信息，如指令、操作数等。数据线的宽度反映一次能传送的数据的位数。
    * 地址线：给出源数据或目的数据所在的主存单元或I/O端口的地址。地址线的宽度反映最大的寻址空间。
    * 控制线：控制对数据线和地址线的访问和使用。用来传输定时信号和命令（读、写）等信息。典型的控制信号包括：
      - 时钟：用于总线同步
      - 复位：初始化所有设备
      - 总线请求：表明发出该请求信号的设备要使用总线
      - 总线允许：表明接收到该允许信号的设备可以使用总线
      - 中断请求：表明某个中断正在请求
      - 中断回答：表明某个中断请求已被接受
      - 存储器读：从指定的主存单元中读数据到数据总线上
      - 存储器写：将数据总线上的数据写到指定的主存单元中
      - I/O读： 从指定的I/O端口中读数据到数据总线上
      - I/O写：将数据总线上的数据写到指定的I/O端口中
      - 传输确认：表示数据已被接收或已被送到总线上
      
## 3.总线的特性和性能指标
总线是一组电导线，在部件间共享传输信息。
总线标准需规定以下基本特性：
+ 物理机械特性：连接类型、数量、接插件的几何尺寸和形状以及引脚线的排列等。
  - 连线类型：电缆式、主板式、底板式
  - 连线数量：串行总线、并行总线
+ 电气特性：每条信号线的信号传递方向、信号的有效电平范围
  - 信号方向：数据为双向、地址为单向、控制为单向
  - 电平表示方式：单端方式、差分方式
+ 功能特性：总线中每根传输线的功能
+ 时间特性：总线中任一根传输线在什么时间有效，以及每根线产生的信号之间的时序关系
尽管有不同实现方式，但总线设计基本要素和性能指标是类似的
+ 总线宽度： 数据线的宽度（8/16/32/64/128位...）
+ 信号线类型：专用信号线/复用信号线
+ 仲裁方式：集中式仲裁/分布式仲裁
+ 定时方式：同步通信/异步通信
+ 事务类型：所支持的数据传输类型和其他总线操作类型
+ 工作频率：早期总线一个时钟周期传送一次数据，工作频率等于时钟频率。现在一个时钟周期可以传送2次或4次数据故工作频率是时钟频率的2或4倍。
+ 总线带宽（最大数据传输率）：每秒钟在总线上能传输的最大字节数。
  - 处理器总线的带宽
    * 早期处理器总线称为前端总线，每个时钟传送一次，供时钟频率和工作频率一致。从pentium pro开始，fsb采用quad pumped技术在每个总线时钟周期内传4次数据总线数据传输率等于总线时钟频率的4倍。
    * Intel推出Core i7时，北桥芯片的功能被集成到CPU芯片内，cPU通过存储器总线直接和内存条相连，在CPU芯片内部的核与核之间、CPU芯片与其他CPU芯片之间，以及CPU芯片与IOH芯片之间则通过QPI总线相连。QPI总线是一种基于包传输的串行高速点对点连接协议。
    * QPI总线的带宽：发送和接收方各有时钟信号，每个时钟周期传输两次。QPI总线有20条数据线，一个QPI数据包包含80位，需要两个时钟周期或4次传输，才能完成整个数据包的传送。在每次传输的20位数据中，有16位是有效数据，其余4位用于循环冗余校验，以提高系统的可靠性。每个QPI总线的带宽计算公式：每秒传输次数*每次传输的有效数据*2
  - I/O总线的带宽
    * I/O总线
      + 用于为各种I/O设备提供输入/输出通路
      + 在物理上通常是主板上的一些I/O扩展槽
      + 早期的第一代I/O总线有XT总线、ISA总线、EISA总线、VESA总线这些I/O总线早已被淘汰
      + 第二代I/O总线包括PCI、AGP、PCI-x
      + 第三代I/O总线是PCI-Express,与前两代I/O总线采用并行传输的同步总线不同，PCI-Express总线采用串行传输方式。
      + 两个PCI-Express设备之间以一个链路相连，每个链路包含多条通路，可能的通路数位1、2、4、8、16、32。每条通路由发送和接收数据线构成，可同时发送和接受数据。在发送和接收过程中，每个数据自己实际上被替换成了10位信息被传输。
## 4.总线结构
+ 总线结构可分为
  - 单总线结构
    * 早期计算机采用单总线结构
      - CPU、主存与I/O模块之间的传送都通过一组总线进行，PDP-11和国产DJS183采用该结构
      - 优缺点：优点：体系结构简单、便于扩充。缺点：所有传送都共享一组总线，极易使总线成为整个系统的瓶颈，使性能下降。
      - 单总线结构性能下降的原因：总线上连接的设备越多，传输延迟就会越大。总线上挂接设备速度差异越大，效率越差。CPU也只能挂接在这个单一的总线上，不能从数据传送操作中解放出来。
   
  - 多总线结构
    * 双总线结构（不分层次/分层次）
      - 不分层次： 在单总线基础上再加一条CPU与主存之间的通路，形成以存储器为中心的双总线结构。国产DJS184机采用该结构
      - 分层次： 将I/O分离出来，集中由IOP管理。将原先的单总线分成主存总线和I/O总线，形成两级双总线结构。
    * 三总线结构（不分层次/分层次）
    * 
    * 多总线分层结构
## 5.总线裁决控制
## 6.总线通信控制
# 第三章总结
***
